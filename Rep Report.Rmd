---
title: "Replication of the article Can’t We All Just Get Along?"
author: "Daniel Benenson Markovits; Nadjim Fréchet; Rémi Thériault; Chris Yurris"
date: "2023-06-14"
output:
  html_document:
    df_print: paged
  pdf_document: default
---



```{r,  echo=FALSE,  message=FALSE, warning == FALSE, echo=FALSE, fig.height = 10, fig.width= 12}
Packages <- c("tidyverse", "stargazer", "fixest", "modelsummary", "haven", "estimatr", "ggtext")
lapply(Packages, library, character.only = T)
options(tibble.print_max = Inf,scipen=999)
```

*Code Here!!!!

We replicated the main results of Adams et al (2023) for the Montreal Replication Games. The main results replicated with the authors initial code and with a simplification of the code using tidyverse (the initial code was written in base R). Our main substantive findings besides this replication is that the results of the paper were driven by left wing respondents and that the main findings were otherwise robust to various additional tests beyond those carried out by the authors. 

We examined the results subsetted by the party family and by left and right blocks. We find highly significant results for left wing parties while right wing and centrist parties exhibit clear null results with some positively and others negatively signed. Substantively we believe this finding matters because of recent literature on democratic backsliding - the threat to democracy today comes mostly from the right Berman (2022) and it is right wing voters who are mostly willing to sacrifice democracy for instrumental reasons (Svolik 2023). It matters then that the portion of women MPs affects the attitudes of left wing voters and not the attitudes of the voters most likely to undermine democracy. We explain this treatment effect heterogeneity because of differences in party level attitudes towards female representation - left wing parties tend to have gender equality in representation written into their platforms. The conditional effect by evaluator party family is below.

We performed a country and year level version of leave one out cross-validation. The results are robust to the exclusion of any country and any year (1996-2007) in the dataset. The exclusion of minor parties from the dataset slightly reduces the main effect size but does not affect their statistical significance or substantive interpretation. 

In addition, we wanted to clarify some aspects of the structure of the data that were not entirely clear from the paper, which is understandable given the paper is a short letter. The CSES data is an individual level dataset with more than 300,000 respondents. Weights are not consistently available for these data sets because of the structure of the CSES. Some country-election year iterations of the data have election weights (where respondents are weighted to election results) while others have demographic weights. In the absence of these weights the dataset is transformed into an (N ~= 2000) average of country-year-dyad affective scores - where each data point is an average of the out-party warmth scores in country I at time T from party A’s assessment of party B. The main analyses are performed on this data. We note that the absence of weighting may affect the results in a number of ways.


```{r,  message=FALSE, warning == FALSE, echo=FALSE, fig.height = 10, fig.width= 12}

party_spec <- function(x){


table1.2 <-lm(party_like ~ to_pfeml + rile_distance_s + prior_coalition + prior_opposition + as.factor(cntryyr), data = dta %>% subset(from_parfam == x), group = "Party") 


fig <- broom::tidy(table1.2) %>% mutate(par_fam = x, group = "Party") %>% subset(term == "to_pfeml")


obs <- nobs(table1.2)

cbind(fig, obs)

}

load("dyadic_data_1-4-22.Rdata")

dta <-updated_data


#creating the country-year fixed effects
dta$cntryyr <-paste(dta$country, dta$year, sep = "")

## Removing smaller parties
dta <- subset(dta, dta$to_prior_seats >=4)




vars <- c("rile_distance_s", "prior_coalition", "prior_opposition", "econ_distance_s", "society_distance_s",
          "year", "country", "party_dislike", "party_like", "cntryyr", "to_pfeml", "to_prior_seats", "to_mp_number", "from_parfam","from_left_bloc")
dta <- dta[vars]
dta <- na.omit(dta)


parties <- unique(dta$from_parfam)

bind_rows(map(parties, party_spec)) %>% mutate(par_fam2 = ifelse(par_fam == "10", "Green", par_fam),
                                              par_fam2 = ifelse(par_fam2 == "20", "Rad Left/Socialist", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "30", "Social Democratic/Center-Left", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "40", "Liberal", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "50", "Christian Democratic", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "60", "Conservative", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "70", "Radical Right", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "80", "Agrarian", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "90", "Regionalist", par_fam2),
                                              par_fam2 = ifelse(par_fam2 == "95", "Misc/Other", par_fam2),
  par_fam2  = paste(par_fam2 , " (n = ", obs, ")", sep = ""),
                                              par_fam2 = fct_reorder(par_fam2, desc(par_fam))) %>% ggplot(aes(x= estimate, y = par_fam2, xmin = estimate - std.error *1.96,
                                                    xmax = estimate + std.error *1.96))  + 
  geom_point() + 
  geom_errorbar(size = .75, color = "red", width = .2) + labs(x = "Subgroup Estimate",
                                                                                                                                                                                            y = "Party Family", title = "Effect of out-party female MP percentage on affective polarization" , subtitle = "By evaluator's party family") + geom_point(size = 2)  + 
  geom_hline(yintercept = 0, linetype = "longdash", color = "red") + 
  geom_errorbar(aes(xmin = estimate - std.error * 1.645, xmax =estimate + std.error  * 1.645), width = 0.2, size = 1, color = "black") + 
  geom_vline(xintercept = 0, color = "red", linetype = "longdash") + 
  theme(panel.spacing = unit(.5, "lines"),
        strip.background = element_blank(),
        strip.placement = "outside",
          axis.text.x=element_text(size=15),
        axis.title.y = element_text(size=15),
        axis.title.x = element_text(size=15),
        legend.position = "bottom",
    plot.caption = ggtext::element_markdown(color = "black",
                                                size = 17),
        axis.text.y=element_text(size=15),
       plot.title = ggtext::element_markdown(size = 20, 
                                             color = "black", 
                                             hjust = 0.5),
    plot.subtitle = ggtext::element_markdown(size = 17, 
                                             color = "black", 
                                             hjust = 0.5),
       panel.grid.major.y = element_line(colour = "#6d6d6d", 
                                         size = 0.5, 
                                         linetype = "dotted"),
       panel.grid.major.x = element_line(colour = "#6d6d6d", 
                                         size = 0.5, 
                                         linetype = "dotted"),
       panel.background = element_rect(fill = 'white'),
        axis.ticks.length.x = unit(.2, "cm"),
       axis.ticks.x = element_line(color = "black"),
       axis.ticks.y = element_line(color = "black"),
       axis.ticks.length.y = unit(.2, "cm"),
       panel.border = element_blank(), 
       
       axis.line = element_line(color = "black"),
    strip.text.x = element_text(size = 15)) + scale_x_continuous(limits = c(-4, 8.05), breaks = seq(-4, 8, 1), expand = c(0,0)) 
```


